TSHARK

Description

TShark is a network protocol analyzer.
It lets you capture packet data from a live network, or read packets from a previously saved capture file, either printing a decoded form of those packets to the standard output or writing the packets to a file. TShark's native capture file format is pcapng format, which is also the format used by Wireshark and various other tools.

Without any options set, TShark will work much like tcpdump.
It will use the pcap library to capture traffic from the first available network interface and displays a summary line on the standard output for each received packet.

Usage Example

To start we can list the interfaces whose traffic tshark can capture with the command:
root@kali:~# tshark -D

We have a long list of interfaces. But for our demonstration we will use the "eth0" interface.
To start capturing traffic on this interface we will use the command

root@kali:~# tshark -i eth0

Well before launching the capture we first generate traffic on the interface with a ping to google.fr .
(ping google.fr)

We can also limit the number of packets we will intercept with the -c option.

root@kali:~# tshark -i eth0 -c 15

We can also get more details about the different packages with the -V option.

We also have the possibility to write the output of the command to a pcap file. To do this we use the -w option

To identify the ip we used the command nslookup google.fr and for the filter applied with tshark we used the command

root@kali:~# tshark -i eth0 -c 15 host ip_address and port 443

'host' is used to identify the host ip address and 'port' is used for the port .

How to analyze a .pcap file with tshark?

To start with we have to use the -r option followed by the name of the .pcap file to read it, which gives

root@kali:~# tshark -r dnsexfil.pcap
(dnsexfil.pcap is the file to be analyzed.)

The -T option is used to generate data in different formats, this can be very useful when you need a specific format for your analysis. In our example we will do it in json. The final command in this case is

root@kali:~# tshark -r dnsexfil.pcap -T json

We can also display the output of the commands in color with the --color option. The command gives

root@kali:~# tshark -r dnsexfil.pcap --color

Conclusion
There is a lot to say about this tool, but I hope that this introduction to tshark has made your mouth water and that it will be useful.
